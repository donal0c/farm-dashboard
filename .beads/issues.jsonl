{"id":"farm-dashboard-21c","title":"Fix My Land and Markets critical UX regressions","description":"Address exact Eircode behavior (P51Y070), non-interactive map behavior, and Markets tab unresponsiveness under filter edits.","status":"closed","priority":0,"issue_type":"bug","owner":"ocallaghandonal2@gmail.com","created_at":"2026-02-07T11:57:12.775883Z","created_by":"Donal","updated_at":"2026-02-07T11:57:12.829801Z","closed_at":"2026-02-07T11:57:12.829801Z","close_reason":"Implemented exact Eircode normalization with Ireland-bounded geocode + routing-area sanity fallback, restored interactive map pan/zoom state, and reworked Markets tab with staged heavy analytics loading plus safer filter application to prevent UI lock-ups. Verified with Playwright, lint, and build."}
{"id":"farm-dashboard-2gq","title":"Build Tab 1: My Land","description":"Implement the My Land tab — the map-centric view of a farmers land parcels, soil, and compliance data.\n\n## Core Features\n1. Eircode routing key search (139-entry static JSON for ~5-30km accuracy) OR map click to set farm location\n2. LPIS field boundary polygons on map (via DAFM OGC Features API: geoapi.opendata.agriculture.gov.ie)\n   - Each parcel shows: crop type, area (ha), tenure status, CAP scheme flags\n   - For production: convert to PMTiles via tippecanoe for fast rendering\n3. Soil type WMS overlay (EPA:SOIL_SISNationalSoils via gis.epa.ie/geoserver/wms)\n4. Nitrate zone overlay (DAFM nitrate derogation zones)\n5. CAP payment summary for selected area (from pre-processed DAFM JSON)\n\n## Map Stack\n- MapLibre GL JS v5 + react-map-gl as base\n- Protomaps PMTiles basemap on R2\n- deck.gl GeoJsonLayer for LPIS parcels\n- MapLibre WMS tile layer for soil overlay\n- Turf.js for parcel area calculations\n\n## Data Sources\n- LPIS GeoAPI (confirmed working, 2,463 parcels per bbox query)\n- EPA WMS (soil, subsoils)\n- DAFM CAP JSON (125K beneficiaries, 2 years)\n- Eircode routing keys (RobertLucey/eircode GitHub)\n\n## GenUI Readiness\n- Map component accepts location + layers as props\n- Parcel info panel is a standalone component (future AI tool: showParcelInfo)","acceptance_criteria":"- [ ] Eircode routing key search locates approximate farm area on map\n- [ ] Map click sets farm location as alternative to Eircode\n- [ ] LPIS field boundary polygons displayed for selected area (via DAFM GeoAPI or PMTiles)\n- [ ] Parcel popup/panel shows crop type, area (ha), tenure status\n- [ ] Soil type WMS layer toggleable on map\n- [ ] Nitrate zone overlay toggleable on map\n- [ ] CAP payment summary displayed for selected county/area","notes":"RESEARCH: CAP Beneficiary Data Access\n- Static JSON files available at capben-ui.apps.services.agriculture.gov.ie/assets/capben/{year}.json (no auth)\n- 125,852 beneficiaries in 2024, EUR 2.1B across 28 counties\n- Only 2 years retained online at a time (currently 2023+2024), older years return 404\n- Schema changed between 2023 (single-letter codes) and 2024 (numbered codes for new CAP Strategic Plan)\n- No live query API — pre-process annually and bundle as static data\n- Bulk CSV/XLSX also on opendata.agriculture.gov.ie\n- Full report: ../ideas_and_research/ireland_data/cap-beneficiary-data-research.md\n\nRESEARCH: LPIS Field Boundary Data\n- FULLY OPEN — DAFM publishes anonymised LPIS parcel polygons for 2017-2024 on data.gov.ie (CC-BY-4.0)\n- Each parcel has: full polygon geometry, crop type, area (ha), tenure status, CAP scheme flags\n- Formats: Shapefile, GeoPackage, PMTiles\n- LIVE API: OGC Features API at geoapi.opendata.agriculture.gov.ie — supports spatial bbox queries, returns GeoJSON, no auth\n- Confirmed working: 2,463 parcels returned for a single bbox query in Co. Meath\n- Identifiers are SHA-256 hashed (anonymised) but parcels can be grouped by holding\n- Mandated by EU High Value Dataset Regulation (2023/138)\n- Recommended: Use GeoAPI for dynamic map loading (MVP), PMTiles for production scale\n- Full report: ../ideas_and_research/ireland_data/lpis-field-boundary-research.md\nImplemented My Land MVP: static 139-entry Eircode routing key search (lib/data/eircode-routing-keys.json), map click location selection, LPIS parcel overlay via /api/data/lpis proxy, EPA soil WMS toggle, nitrates overlay toggle via /api/data/nitrates proxy, parcel preview panel (crop/area/tenure fields), and CAP county payment summary via /api/data/cap-summary. Verified with npm run lint, npm run build, and Playwright interactions on /my-land.","status":"closed","priority":2,"issue_type":"task","owner":"ocallaghandonal2@gmail.com","created_at":"2026-02-07T08:35:44.092574Z","created_by":"Donal","updated_at":"2026-02-07T10:29:06.790301Z","closed_at":"2026-02-07T10:29:06.790301Z","close_reason":"My Land tab implemented and validated: search/map location, LPIS polygons, soil+nitrate overlays, parcel details panel, CAP summary.","dependencies":[{"issue_id":"farm-dashboard-2gq","depends_on_id":"farm-dashboard-505","type":"parent-child","created_at":"2026-02-07T08:35:57.738306Z","created_by":"Donal"},{"issue_id":"farm-dashboard-2gq","depends_on_id":"farm-dashboard-e61","type":"blocks","created_at":"2026-02-07T08:36:34.860255Z","created_by":"Donal"}]}
{"id":"farm-dashboard-3n5","title":"Gate GenUI sidebar behind feature flag","description":"Hide GenUI sidebar by default until full implementation is ready; enable only via NEXT_PUBLIC_ENABLE_GENUI=true.","status":"closed","priority":2,"issue_type":"task","owner":"ocallaghandonal2@gmail.com","created_at":"2026-02-07T12:17:14.890585Z","created_by":"Donal","updated_at":"2026-02-07T12:17:19.305684Z","closed_at":"2026-02-07T12:17:19.305684Z","close_reason":"Added NEXT_PUBLIC_ENABLE_GENUI gate in app shell, default false in .env.example, and README env docs. Verified no GenUI sidebar rendered by default with Playwright."}
{"id":"farm-dashboard-505","title":"Farm Dashboard — Agricultural Intelligence App","description":"Build a comprehensive agricultural intelligence dashboard for Irish farmers, policy makers, and the agri-food industry. Combines data from DAFM, Teagasc, CSO, EPA, Met Eireann, Marine Institute and more into a unified app with 4 main tabs covering land, markets, weather, and environmental compliance.","design":"## Tech Stack (Finalised)\n\n- Frontend: Next.js 16 + React 19 + Turbopack + Tailwind CSS v4\n- UI: shadcn/ui + Tremor (KPI cards, metrics)\n- Charts: ECharts 6.0 (primary) + Recharts (via Tremor)\n- Maps: MapLibre GL JS v5 + deck.gl 9.2 + react-map-gl 8.x\n- Tiles: PMTiles on Cloudflare R2 (self-hosted basemap via Protomaps)\n- Spatial: Turf.js 7.2 for client-side analysis\n- API: Hono + tRPC v11 (SSE subscriptions for real-time)\n- Database: Supabase Postgres (EU region) + TimescaleDB extension\n- Cache: Upstash Redis (serverless)\n- Python pipeline: FastAPI + Polars + DuckDB (ETL, Parquet generation)\n- Client analytics: DuckDB-WASM querying Parquet on R2\n- Data fetching: TanStack Query v5\n- State: Zustand\n- Data tables: TanStack Table v8 (via shadcn DataTable)\n- Deploy: Fly.io Dublin (API) + Cloudflare Pages (frontend) + Cloudflare R2 (data/tiles)\n- Tooling: Biome (lint/format), TypeScript 5.7\n- Cost: ~$45-70/month\n\n## Architecture\n\n### Tab 1: My Land\n- DAFM LPIS parcels via OGC Features API (geoapi.opendata.agriculture.gov.ie) — GeoJSON, no auth\n- LPIS PMTiles for production scale (tippecanoe conversion)\n- EPA soil maps via WMS (gis.epa.ie/geoserver/wms, layer EPA:SOIL_SISNationalSoils)\n- DAFM nitrate zones via WMS/SHP\n- CAP beneficiary data from static JSON (capben-ui.apps.services.agriculture.gov.ie/assets/capben/{year}.json)\n- Eircode routing key lookup (139-entry static JSON) + map click for farm location\n\n### Tab 2: Markets \u0026 Income\n- CSO PxStat API: AEA01 (55 income metrics, 1990-2025), ACA03 (regional, 11 NUTS3)\n- CSO AHM05 (monthly price indices: cattle, milk, sheep, crops from Jan 2020)\n- CSO AAA09 (livestock numbers), AKM03 (dairy production), ADM01 (slaughterings)\n- CSO PFSA03 (fertiliser sales), AJM09 (fertiliser prices)\n- DAFM agri-food exports via data.gov.ie CSV\n- CAP payment aggregations (county-level from pre-processed JSON)\n\n### Tab 3: Weather \u0026 Water\n- Met Eireann ag weather: prodapi.metweb.ie/agriculture/report (JSON, daily, 16 stations)\n- Met Eireann observations: prodapi.metweb.ie/observations/{station}/today (JSON, hourly, 25 stations)\n- Met Eireann warnings: met.ie/Open_Data/json/warning_IRELAND.json\n- Met Eireann historical: cli.fusio.net/cli/climate_data/webdata/dly{id}.csv (1940s-present)\n- OPW water levels: waterlevel.ie/geojson/latest/ (537 stations, 15-min, GeoJSON)\n- Marine Institute ERDDAP: tide gauges, weather buoys\n\n### Tab 4: Environment \u0026 Compliance\n- EPA WFD API: wfdapi.edenireland.ie (water body status — needs API key)\n- EPA WMS layers: WFD waterbodies, CORINE land cover, ag pressures, groundwater vulnerability\n- CSO EAA01 (GHG emissions by sector)\n- NBDC biodiversity: maps.biodiversityireland.ie (CSV downloads, 9.1M records)\n- DAFM nitrate derogation zones (SHP/GeoJSON)\n\n## GenUI (Future Phase)\nArchitecture designed for future Vercel AI SDK integration:\n- Keep chart/table/map components modular and data-driven\n- Components should accept props that could be generated by LLM tool calls\n- Future: AI chat sidebar with tools like showBarChart, showDataTable, showMap\n- Protocol: AG-UI for agent-frontend communication, MCP for data connectivity\n- Reference: ../ideas_and_research/genui/genui-index.md\n\n## Data Sources Reference\nFull research in ../ideas_and_research/ireland_data/\nKey reports: ireland-agriculture-data-sources.md, ireland-environmental-data-sources.md, ireland-gis-data-sources.md, ireland-open-data-report.md\nAdditional research: eircode-geocoding-research.md, lpis-field-boundary-research.md, farm-income-data-research.md, cap-beneficiary-data-research.md","acceptance_criteria":"- [ ] Tab 1 (My Land): Display LPIS parcels on map with soil type overlay and nitrate zones\n- [ ] Tab 2 (Markets \u0026 Income): Charts showing farm income trends, livestock prices, export data\n- [ ] Tab 3 (Weather \u0026 Water): Live weather data, water levels on map, historical weather explorer\n- [ ] Tab 4 (Environment \u0026 Compliance): EPA water quality status on map, biodiversity records, carbon data\n- [ ] Responsive design that works on tablet (farmers in the field)\n- [ ] Data refresh indicators showing when each source was last updated\n- [ ] Eircode or map-click to anchor all tabs to a specific farm location","notes":"KEY REFERENCE: Research reports in ../ideas_and_research/ireland_data/\n- ../ideas_and_research/ireland_data/ireland-agriculture-data-sources.md (55+ sources, 15 orgs)\n- ../ideas_and_research/ireland_data/ireland-environmental-data-sources.md (EPA, water quality, biodiversity)\n- ../ideas_and_research/ireland_data/ireland-energy-data-sources.md (EirGrid, SEAI)\n- ../ideas_and_research/ireland_data/ireland-gis-data-sources.md (Tailte Eireann boundaries, mapping)\n- ../ideas_and_research/ireland_data/ireland-open-data-report.md (CSO PxStat API patterns, data.gov.ie)\n\nIdeas bead: ideas_and_research-7vf in ../ideas_and_research/.beads/\n\nRESEARCH: Eircode Geocoding\n- No free Eircode-to-coordinate API exists (ECAD database is commercially licensed)\n- Official Eircode Finder API (api-finder.eircode.ie) undocumented and returning 500 errors\n- OSM Nominatim does NOT resolve Eircodes (tested, confirmed)\n- Google Maps: 10k free/month, Mapbox: 100k free/month — both likely support Eircodes but need keys to verify\n- RECOMMENDED FREE APPROACH: Routing key lookup table — 139 routing keys map to known towns/areas, geocode once via Nominatim, store as static JSON (~5-30km accuracy, zero runtime API calls)\n- Best architecture: instant routing key lookup (client-side) + optional Google/Mapbox for precise coords, cached aggressively\n- RobertLucey/eircode GitHub repo has complete 139-key mapping\n- Full report: ../ideas_and_research/ireland_data/eircode-geocoding-research.md","status":"closed","priority":1,"issue_type":"epic","owner":"ocallaghandonal2@gmail.com","created_at":"2026-02-07T08:35:22.629098Z","created_by":"Donal","updated_at":"2026-02-07T11:12:06.045433Z","closed_at":"2026-02-07T11:12:06.045433Z","close_reason":"Core dashboard delivery complete: API validation, scaffolding, Tabs 1-4 implementation, and GenUI sidebar scaffold all closed and validated with lint/build plus Playwright flows."}
{"id":"farm-dashboard-9pt","title":"GenUI Phase 2: Wire real LLM provider and tool dispatch","description":"Replace deterministic mock routing in /api/genui/chat with provider-backed tool selection and response generation, keeping existing tool contract and sidebar rendering. Include env-based provider config and fallback behavior.","status":"open","priority":2,"issue_type":"feature","owner":"ocallaghandonal2@gmail.com","created_at":"2026-02-07T11:28:05.273245Z","created_by":"Donal","updated_at":"2026-02-07T11:28:05.273245Z"}
{"id":"farm-dashboard-e61","title":"Set up project scaffolding and tech stack","description":"Initialise the farm-dashboard project with the finalised tech stack. Set up build tooling, dev server, and the full project structure.\n\n## Scaffolding Tasks\n1. next.js 16 project init with TypeScript, Tailwind v4, Turbopack\n2. shadcn/ui init + Tremor install\n3. Biome setup (replaces ESLint + Prettier)\n4. MapLibre GL JS + react-map-gl rendering a base map of Ireland (centered -7.5, 53.5, zoom 6.5)\n5. ECharts 6.0 rendering a sample chart\n6. Tab navigation structure (4 tabs: My Land, Markets \u0026 Income, Weather \u0026 Water, Environment \u0026 Compliance)\n7. Basic responsive layout with shadcn/ui Sidebar\n8. Dark/light theme toggle via shadcn/ui theming\n9. TanStack Query provider setup\n10. Zustand store skeleton\n11. tRPC client/server skeleton (Hono API on separate route or standalone)\n12. Supabase client init (env vars, no schema yet)\n13. Project structure: app/(tabs)/, components/, lib/, server/\n\n## Key Decisions Locked In\n- Frontend: Next.js 16, React 19, Tailwind v4, shadcn/ui, Tremor\n- Maps: MapLibre GL JS v5 + react-map-gl (NOT Leaflet)\n- Charts: ECharts 6.0 (primary), Recharts via Tremor (KPI cards)\n- API: Hono + tRPC v11\n- State: TanStack Query (server) + Zustand (client)\n- Tooling: Biome, TypeScript 5.7\n\n## Tech Stack Reference\n../ideas_and_research/technology_stack/08_recommended_stack.md","acceptance_criteria":"- [ ] Next.js 16 project initialised with TypeScript, Tailwind v4, Turbopack\n- [ ] shadcn/ui and Tremor installed and rendering\n- [ ] Biome configured for linting and formatting\n- [ ] MapLibre GL JS rendering a base map of Ireland (centred on Ireland)\n- [ ] ECharts rendering a sample chart\n- [ ] 4-tab navigation structure in place (My Land, Markets \u0026 Income, Weather \u0026 Water, Environment \u0026 Compliance)\n- [ ] Dark/light theme toggle working\n- [ ] TanStack Query and Zustand providers configured\n- [ ] tRPC client/server skeleton functional\n- [ ] Dev server running with hot reload","notes":"Depends on API validation task (farm-dashboard-ebk) to know which sources need proxy vs browser-direct.\nCORS findings will determine whether Hono API proxies all sources or only some.\nScaffold complete on 2026-02-07: Next.js 16 + React 19 + TS + Tailwind v4 + Turbopack; shadcn init artifacts + custom ui primitives; Tremor sample rendered; Biome configured and lint passes; 4-tab sidebar navigation + theme toggle; MapLibre centered on Ireland + ECharts sample + Tremor sample; TanStack Query + Zustand provider/store; tRPC endpoint /api/trpc and Hono endpoint /api/hono/health verified via curl; Supabase client + .env.example created.","status":"closed","priority":1,"issue_type":"task","owner":"ocallaghandonal2@gmail.com","created_at":"2026-02-07T08:35:44.029245Z","created_by":"Donal","updated_at":"2026-02-07T10:24:43.167406Z","closed_at":"2026-02-07T10:24:43.167406Z","close_reason":"Scaffolding and stack setup completed, verified by npm run lint, npm run build, Playwright UI checks, and API endpoint smoke tests.","dependencies":[{"issue_id":"farm-dashboard-e61","depends_on_id":"farm-dashboard-505","type":"parent-child","created_at":"2026-02-07T08:35:57.689457Z","created_by":"Donal"},{"issue_id":"farm-dashboard-e61","depends_on_id":"farm-dashboard-ebk","type":"blocks","created_at":"2026-02-07T08:36:34.811482Z","created_by":"Donal"}]}
{"id":"farm-dashboard-ebk","title":"Validate and test all data source APIs","description":"Before building, verify every API endpoint works. Test from both curl (server-side) and browser fetch (CORS). Document response formats, rate limits, and categorise sources.\n\n## APIs to Test\n\n### Tier 1 — REST/JSON (browser fetch test + curl)\n- CSO PxStat: curl \"https://ws.cso.ie/public/api.restful/PxStat.Data.Cube_API.ReadDataset/AAA09/JSON-stat/2.0/en\"\n- Met Eireann ag weather: curl \"https://prodapi.metweb.ie/agriculture/report\"\n- Met Eireann observations: curl \"https://prodapi.metweb.ie/observations/dublin-airport/today\"\n- Met Eireann warnings: curl \"https://www.met.ie/Open_Data/json/warning_IRELAND.json\"\n- OPW water levels: curl \"http://waterlevel.ie/geojson/latest/\" (NOTE: HTTP not HTTPS)\n- DAFM LPIS GeoAPI: curl \"https://geoapi.opendata.agriculture.gov.ie/...\" (test bbox query)\n- DAFM CAP JSON: curl \"https://capben-ui.apps.services.agriculture.gov.ie/assets/capben/2024.json\"\n- Marine Institute ERDDAP: curl \"https://erddap.marine.ie/erddap/tabledap/IWBNetwork.json?...\"\n\n### Tier 2 — WMS/WFS (test GetCapabilities + sample GetFeature)\n- EPA GeoServer WMS: https://gis.epa.ie/geoserver/wms?SERVICE=WMS\u0026REQUEST=GetCapabilities\n- EPA GeoServer WFS: test outputFormat=application/json for GeoJSON\n- EPA WFD API: https://wfdapi.edenireland.ie (needs API key — how to get one?)\n\n### Tier 3 — ArcGIS REST\n- Tailte Eireann boundaries: https://services-eu1.arcgis.com/FH5XCsx8rYXqnjF5/arcgis/rest/services/...\n- GSI geology: https://gsi.geodata.gov.ie/server/rest/services/...\n\n## For Each Source Document\n- HTTP status code and response time\n- CORS headers (Access-Control-Allow-Origin)\n- Response format and size\n- Rate limit headers if any\n- Classification: browser-safe | needs-proxy | needs-api-key\n- Any broken/deprecated endpoints with alternatives","acceptance_criteria":"- [ ] Each API tested with curl and response format documented\n- [ ] CORS headers checked for each source (Access-Control-Allow-Origin)\n- [ ] Sources categorised: browser-safe vs needs-proxy vs needs-api-key\n- [ ] OPW HTTP/HTTPS mixed content issue documented with solution\n- [ ] EPA WFD API key acquisition process documented\n- [ ] Any broken/deprecated endpoints flagged with alternatives\n- [ ] Results written to a reference doc or bead notes for scaffolding task","notes":"2026-02-07 validation artifacts created: docs/reference/api-source-validation-2026-02-07.md, output/api-checks/*.tsv, config/data-sources.json, scripts/validate_sources.sh. Major findings: OPW endpoint is HTTP-only (mixed-content in browser), DAFM LPIS ArcGIS path is 404 (OGC /shps alternative found but CORS-blocked), EPA WFS sample typeName invalid (AIR_NO2 confirmed valid), WFD root 403 but /api/catchment works. Pending: formal EPA WFD API key onboarding research from docs/research/api-sources.","status":"closed","priority":0,"issue_type":"task","owner":"ocallaghandonal2@gmail.com","created_at":"2026-02-07T08:35:43.966685Z","created_by":"Donal","updated_at":"2026-02-07T10:17:50.161834Z","closed_at":"2026-02-07T10:17:50.161834Z","close_reason":"API validation complete with curl + browser fetch matrices, CORS/rate-limit docs, classification, broken endpoint alternatives, OPW mixed-content mitigation, and WFD onboarding notes in docs/reference/api-source-validation-2026-02-07.md","dependencies":[{"issue_id":"farm-dashboard-ebk","depends_on_id":"farm-dashboard-505","type":"parent-child","created_at":"2026-02-07T08:35:57.638843Z","created_by":"Donal"}]}
{"id":"farm-dashboard-ett","title":"Build Tab 4: Environment \u0026 Compliance","description":"Implement the Environment \u0026 Compliance tab — EPA water quality, biodiversity, nitrate compliance, carbon.\n\n## Core Features\n1. EPA WFD water quality status on map\n   - River/lake/groundwater body status (colour-coded: High/Good/Moderate/Poor/Bad)\n   - Via EPA WFD API (wfdapi.edenireland.ie — needs API key) or WFS fallback\n   - Catchment-level summary charts\n2. Nitrate compliance\n   - DAFM nitrate derogation zones overlay on map\n   - EPA nitrogen/phosphorus susceptibility WMS layers\n   - EPA agricultural pressures WMS layers (groundwater, river, lake)\n3. Biodiversity records\n   - NBDC data searchable by area (CSV downloads from maps.biodiversityireland.ie)\n   - Species count by grid square / protected species in area\n4. Carbon emissions\n   - CSO EAA01 GHG emissions by agricultural sector (time series)\n   - ECharts bar/line chart showing ag sector contribution\n5. CORINE land cover\n   - EPA WMS layer EPA:LAND_CLC18 (toggleable overlay)\n   - Land cover change layer EPA:LAND_CLCCH_12_18\n\n## Map \u0026 Chart Stack\n- MapLibre WMS layers for EPA data (soil, water quality, CORINE, nitrates)\n- deck.gl for biodiversity point data (ScatterplotLayer)\n- ECharts for emissions time-series and catchment summaries\n- Tremor KPI cards for area compliance status\n\n## Data Considerations\n- EPA WFD API requires API key — investigate how to obtain\n- EPA WMS default CRS is EPSG:29902 (Irish Grid) — request with srsName=EPSG:4326\n- NBDC has no REST API — pre-process CSV data or use data.gov.ie CKAN to find downloads\n- Some EPA endpoints return 404 — WFD API via wfdapi.edenireland.ie is most reliable","acceptance_criteria":"- [ ] EPA water quality status displayed on map (colour-coded: High/Good/Moderate/Poor/Bad)\n- [ ] Water quality data sourced from EPA WFD API or WFS fallback if API key unavailable\n- [ ] Nitrate zone compliance overlay for selected farm area\n- [ ] EPA agricultural pressure layers available (nitrogen/phosphorus susceptibility)\n- [ ] Biodiversity records searchable by area (NBDC data, species counts)\n- [ ] Agricultural GHG emissions charted by sector (CSO EAA01, time series)\n- [ ] CORINE land cover layer toggleable on map","notes":"Implemented Environment \u0026 Compliance tab with EPA WFD status map layers (WFS fallback), DAFM nitrate compliance overlay, EPA susceptibility/pressure WMS overlays, CORINE and CORINE change toggles, biodiversity area search API (NBDC-style sample dataset with species counts), and CSO EAA01 agricultural GHG time-series chart. Added APIs /api/data/epa/wfd-status and /api/data/biodiversity/search plus EAA01 support in CSO proxy.","status":"closed","priority":2,"issue_type":"task","owner":"ocallaghandonal2@gmail.com","created_at":"2026-02-07T08:35:44.289841Z","created_by":"Donal","updated_at":"2026-02-07T11:09:00.384787Z","closed_at":"2026-02-07T11:09:00.384787Z","close_reason":"Tab 4 completed with compliance map overlays, biodiversity area search, and agricultural emissions charting.","dependencies":[{"issue_id":"farm-dashboard-ett","depends_on_id":"farm-dashboard-505","type":"parent-child","created_at":"2026-02-07T08:35:57.885585Z","created_by":"Donal"},{"issue_id":"farm-dashboard-ett","depends_on_id":"farm-dashboard-e61","type":"blocks","created_at":"2026-02-07T08:36:35.007255Z","created_by":"Donal"}]}
{"id":"farm-dashboard-k54","title":"Build Tab 3: Weather \u0026 Water","description":"Implement the Weather \u0026 Water tab — live agricultural weather, water levels, and historical data.\n\n## Core Features\n1. Current agricultural weather (Met Eireann prodapi.metweb.ie/agriculture/report)\n   - 16 stations with 7-day rolling averages\n   - Temperature, rainfall, sunshine, soil temp, wind, solar radiation\n   - Comparison to 30-year baseline (difference/percentage)\n2. Live weather observations (prodapi.metweb.ie/observations/{station}/today, hourly, 25 stations)\n3. Weather warnings (met.ie/Open_Data/json/warning_IRELAND.json — must display per licence)\n4. OPW water level stations on map (waterlevel.ie/geojson/latest/, 537 stations, 15-min)\n   - Color-coded markers by level/trend\n   - Click for station detail + CSV time series\n5. Historical weather explorer\n   - Station selector (25 Met Eireann stations)\n   - Date range picker\n   - CSV data from cli.fusio.net/cli/climate_data/webdata/dly{id}.csv (1940s-present)\n   - Chart: temperature, rainfall, soil moisture deficit\n\n## Map \u0026 Chart Stack\n- MapLibre markers/circles for weather stations and OPW stations\n- ECharts 6.0 for time-series (historical weather, water levels)\n- Tremor KPI cards for current conditions\n- Tremor Tracker for weather warnings\n\n## Real-Time\n- SSE via tRPC for OPW water level updates (poll every 15 min server-side)\n- Met Eireann observations refresh hourly\n- TanStack Query with appropriate staleTime per source\n\n## Data Considerations\n- OPW uses HTTP (not HTTPS) — mixed content issue, needs proxy\n- Met Eireann CORS unconfirmed — may need proxy\n- Historical CSVs are large — consider DuckDB-WASM for client-side querying","acceptance_criteria":"- [ ] Current agricultural weather displayed (Met Eireann ag report, 16 stations with baseline comparison)\n- [ ] Live weather observations shown (Met Eireann, hourly, 25 stations)\n- [ ] Active weather warnings displayed prominently (required by Met Eireann licence)\n- [ ] OPW water level stations displayed on map with current readings (537 stations)\n- [ ] Station click shows detail and recent time series\n- [ ] Historical weather explorer: station selector, date range, chart of temperature/rainfall/soil moisture\n- [ ] Real-time updates working via SSE or polling for OPW and Met Eireann data","notes":"Implemented Weather \u0026 Water tab with live data proxies and polling. Added Met ag report KPIs, hourly observations selector/chart, weather warnings banner with licence note, OPW water level map (537 station feed) with marker selection scaffold and station CSV time-series endpoint, and historical weather explorer with station selector/date range chart (temperature/rainfall/soil moisture deficit). Added APIs: /api/data/met/* and /api/data/opw/* with proxy handling for CORS/mixed-content sources.","status":"closed","priority":2,"issue_type":"task","owner":"ocallaghandonal2@gmail.com","created_at":"2026-02-07T08:35:44.22509Z","created_by":"Donal","updated_at":"2026-02-07T11:02:32.106158Z","closed_at":"2026-02-07T11:02:32.106158Z","close_reason":"Tab 3 completed with live weather/water feeds, historical explorer, and polling-based near-real-time updates.","dependencies":[{"issue_id":"farm-dashboard-k54","depends_on_id":"farm-dashboard-505","type":"parent-child","created_at":"2026-02-07T08:35:57.834598Z","created_by":"Donal"},{"issue_id":"farm-dashboard-k54","depends_on_id":"farm-dashboard-e61","type":"blocks","created_at":"2026-02-07T08:36:34.957954Z","created_by":"Donal"}]}
{"id":"farm-dashboard-moi","title":"Research: LPIS field boundary data availability","status":"tombstone","priority":1,"issue_type":"task","owner":"ocallaghandonal2@gmail.com","created_at":"2026-02-07T09:20:46.703899Z","created_by":"Donal","updated_at":"2026-02-07T09:24:15.73758Z","deleted_at":"2026-02-07T09:24:15.73758Z","deleted_by":"Donal","delete_reason":"delete","original_type":"task"}
{"id":"farm-dashboard-mqb","title":"Research: CAP beneficiary data access","status":"tombstone","priority":1,"issue_type":"task","owner":"ocallaghandonal2@gmail.com","created_at":"2026-02-07T09:20:46.843253Z","created_by":"Donal","updated_at":"2026-02-07T09:24:15.83954Z","deleted_at":"2026-02-07T09:24:15.83954Z","deleted_by":"Donal","delete_reason":"delete","original_type":"task"}
{"id":"farm-dashboard-ov8","title":"Fix Eircode matching and harden Markets tab","description":"My Land should accept full 7-character Eircodes by deriving routing key; Markets \u0026 Income should tolerate malformed/partial source data without crashing.","status":"closed","priority":1,"issue_type":"bug","owner":"ocallaghandonal2@gmail.com","created_at":"2026-02-07T11:40:17.941467Z","created_by":"Donal","updated_at":"2026-02-07T11:40:18.001408Z","closed_at":"2026-02-07T11:40:18.001408Z","close_reason":"Implemented full-Eircode routing-key extraction, safe JSON-stat decode path, clamped year inputs, and dataset warning UI; verified with Playwright and lint/build."}
{"id":"farm-dashboard-rqe","title":"Research: Farm income data alternatives (CSO)","status":"tombstone","priority":1,"issue_type":"task","owner":"ocallaghandonal2@gmail.com","created_at":"2026-02-07T09:20:46.770788Z","created_by":"Donal","updated_at":"2026-02-07T09:24:15.788661Z","deleted_at":"2026-02-07T09:24:15.788661Z","deleted_by":"Donal","delete_reason":"delete","original_type":"task"}
{"id":"farm-dashboard-shy","title":"Build Tab 2: Markets \u0026 Income","description":"Implement the Markets \u0026 Income tab — charts showing farm economics, prices, and trade data.\n\n## Core Features\n1. Farm income trend chart (CSO AEA01: 55 metrics, 1990-2025)\n   - Sector output breakdown as proxy for farm-type income (cattle, milk, sheep, crops)\n   - Regional breakdown via ACA03 (11 NUTS3 regions)\n2. Livestock price charts (CSO AHM05: monthly indices from Jan 2020 — cattle, milk, sheep, crops)\n3. Livestock numbers (CSO AAA09) and slaughterings (CSO ADM01)\n4. Dairy production (CSO AKM03 monthly)\n5. Fertiliser prices (CSO AJM09) and sales (CSO PFSA03)\n6. Export statistics (DAFM agri-food exports CSV via data.gov.ie)\n7. CAP payment county aggregations (from pre-processed DAFM JSON)\n\n## Chart Stack\n- ECharts 6.0 for time-series (line, bar, area with dataZoom)\n- Tremor KPI cards for headline figures (total ag output, export value, avg price)\n- TanStack Table for tabular data (county comparisons, commodity breakdowns)\n\n## Data Handling\n- CSO JSON-stat 2.0 needs parser (jsonstat library or custom)\n- Cache CSO responses (TanStack Query staleTime: datasets update monthly/quarterly)\n- Pre-aggregate CAP data at build time or via Python pipeline\n\n## GenUI Readiness\n- Chart components accept data + config as props\n- Each chart type wrappable as AI tool (showPriceTrend, showIncomeBreakdown)","acceptance_criteria":"- [ ] Agricultural output trend chart (CSO AEA01 sector breakdown: cattle, milk, sheep, crops as proxy for farm-type income)\n- [ ] Regional income comparison (CSO ACA03, 11 NUTS3 regions)\n- [ ] Monthly livestock/crop price index charts (CSO AHM05)\n- [ ] Livestock numbers and slaughterings charts (CSO AAA09, ADM01)\n- [ ] Fertiliser price and sales data displayed (CSO AJM09, PFSA03)\n- [ ] Export statistics visualisation (DAFM agri-food exports)\n- [ ] JSON-stat 2.0 responses parsed and rendered correctly\n- [ ] Data filterable by region and time period","notes":"RESEARCH: Farm Income Data Alternatives\n- CSO AEA01: 55 income/output/input metrics, 1990-2025, free JSON API (no auth) — includes Entrepreneurial Income, Factor Income, Operating Surplus, output by sector (cattle, milk, sheep, crops)\n- CSO ACA03: Regional breakdown (11 NUTS3 regions), 2010-2024, same 44 metrics — Southern region as dairy proxy\n- CSO AHM05: Monthly price indices for cattle, milk, sheep, crops from Jan 2020 — ideal for market price charts\n- CRITICAL GAP: No public API for farm-type-specific income (dairy vs beef vs sheep vs tillage)\n- Teagasc Power BI dashboard exists with NFS enterprise data but cannot be consumed programmatically\n- Eurostat mirrors CSO data with 50+ year time series (back to 1973), adds income-per-worker indices\n- Revenue Commissioners: county-level average farm income CSV (2013-2018) from tax records — unique but limited years\n- RECOMMENDED: Use CSO AEA01 sector output as proxy for farm-type income trends + manually extracted Teagasc factsheet data (6 enterprises, annual)\n- Full report: ../ideas_and_research/ireland_data/farm-income-data-research.md\nImplemented Markets \u0026 Income tab with live datasets: CSO AEA01/ACA03/AHM05/AAA09/ADM01/AKM03/AJM09/PFSA03 via /api/data/cso/[dataset] proxy, DAFM exports CSV via /api/data/exports, CAP county aggregation table via /api/data/cap-counties. Added JSON-stat parser (lib/cso/jsonstat.ts), ECharts visualizations for all required domains, TanStack table for county comparison, and region/year filtering controls.","status":"closed","priority":2,"issue_type":"task","owner":"ocallaghandonal2@gmail.com","created_at":"2026-02-07T08:35:44.156414Z","created_by":"Donal","updated_at":"2026-02-07T10:57:24.68278Z","closed_at":"2026-02-07T10:57:24.68278Z","close_reason":"Tab 2 completed with real data charts/tables, JSON-stat parsing, and region/time filters.","dependencies":[{"issue_id":"farm-dashboard-shy","depends_on_id":"farm-dashboard-505","type":"parent-child","created_at":"2026-02-07T08:35:57.78644Z","created_by":"Donal"},{"issue_id":"farm-dashboard-shy","depends_on_id":"farm-dashboard-e61","type":"blocks","created_at":"2026-02-07T08:36:34.908893Z","created_by":"Donal"}]}
{"id":"farm-dashboard-vg6","title":"GenUI Integration — AI chat sidebar and tool-based UI","description":"Add generative UI capabilities to the farm dashboard. This is a future phase — all 4 tabs should be built and stable first. Decisions on framework and approach still to be made.\n\n## Concept\n- AI chat sidebar where users can ask natural language questions about their farm data\n- Tool-based generative UI: LLM selects pre-built components via tool calls (showBarChart, showDataTable, showMap, showParcelInfo)\n- Dashboard components already built for Tabs 1-4 become the tool library\n\n## Recommended Stack (from research)\n- Vercel AI SDK (tool-based generative UI, 2M+ weekly downloads, MIT)\n- OR CopilotKit (if more complex agent workflows needed)\n- MCP servers for data connectivity (CSO, EPA, Met Eireann as MCP tools)\n- AG-UI protocol for agent-frontend communication\n\n## Hybrid Architecture\nPre-built dashboard shell (Tabs 1-4) + AI chat sidebar for ad-hoc queries:\n- Fixed KPI cards and standard charts remain pre-built\n- AI generates additional views on demand\n- Anomaly detection / proactive alerts (future)\n\n## Prerequisites\n- All tab components must be modular and accept data+config as props (designed for this)\n- LLM API costs need budgeting (not included in current $45-70/mo estimate)\n- Decision needed: which LLM provider (Claude API, OpenAI, etc.)\n- Decision needed: Vercel AI SDK vs CopilotKit vs custom\n\n## Research Reference\n- ../ideas_and_research/genui/genui-index.md (executive summary, framework comparison, dashboard decision framework)\n- ../ideas_and_research/genui/genui-frameworks.md (detailed framework analysis)\n- ../ideas_and_research/genui/genui-dashboards.md (dashboard-specific approaches)\n- ../ideas_and_research/genui/genui-protocol-ag-ui.md (AG-UI protocol details)","notes":"BLOCKED: Decisions pending on LLM provider, framework choice, and cost model. Do not start until all 4 tabs are stable and the component library is proven.\n\nThis bead exists so the GenUI plan is not lost across sessions.\nImplemented GenUI scaffold: right-side AI chat sidebar integrated into app shell, tool-call contract (showBarChart/showDataTable/showMap/showParcelInfo), chat API endpoint /api/genui/chat, and dynamic tool rendering in UI. Added provider-agnostic deterministic tool router as baseline for later LLM provider wiring. Also fixed duplicate key regression in My Land parcel preview while validating sidebar flows.","status":"closed","priority":4,"issue_type":"feature","owner":"ocallaghandonal2@gmail.com","created_at":"2026-02-07T09:59:19.10606Z","created_by":"Donal","updated_at":"2026-02-07T11:11:41.555508Z","closed_at":"2026-02-07T11:11:41.555508Z","close_reason":"GenUI sidebar/tool scaffold integrated and validated; ready for provider-specific LLM upgrade phase.","dependencies":[{"issue_id":"farm-dashboard-vg6","depends_on_id":"farm-dashboard-2gq","type":"blocks","created_at":"2026-02-07T09:59:42.60608Z","created_by":"Donal"},{"issue_id":"farm-dashboard-vg6","depends_on_id":"farm-dashboard-shy","type":"blocks","created_at":"2026-02-07T09:59:42.664605Z","created_by":"Donal"},{"issue_id":"farm-dashboard-vg6","depends_on_id":"farm-dashboard-k54","type":"blocks","created_at":"2026-02-07T09:59:42.721256Z","created_by":"Donal"},{"issue_id":"farm-dashboard-vg6","depends_on_id":"farm-dashboard-ett","type":"blocks","created_at":"2026-02-07T09:59:42.77709Z","created_by":"Donal"}]}
{"id":"farm-dashboard-yka","title":"Research: Eircode geocoding options","status":"tombstone","priority":1,"issue_type":"task","owner":"ocallaghandonal2@gmail.com","created_at":"2026-02-07T09:20:46.6359Z","created_by":"Donal","updated_at":"2026-02-07T09:24:15.682736Z","deleted_at":"2026-02-07T09:24:15.682736Z","deleted_by":"Donal","delete_reason":"delete","original_type":"task"}
